<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Website</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Loading State */
        #loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-size: 24px;
            color: #666;
        }

        #loading.hidden {
            display: none;
        }

        #content {
            display: none;
        }

        #content.visible {
            display: block;
        }

        /* Site Header (Row 2) */
        .site-header {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .site-header h1 {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .site-header .hero-image {
            max-width: 100%;
            height: auto;
            max-height: 400px;
            margin: 30px auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .site-header .slogan {
            font-size: 24px;
            margin: 20px 0;
            font-weight: 300;
            font-style: italic;
        }

        .site-header .intro-text {
            font-size: 18px;
            max-width: 800px;
            margin: 20px auto;
            line-height: 1.8;
        }

        /* Content Sections (Row 5+) */
        .content-section {
            padding: 60px 20px;
            border-bottom: 1px solid #eee;
        }

        .content-section:nth-child(even) {
            background-color: #f9f9f9;
        }

        .content-section h2 {
            font-size: 32px;
            margin-bottom: 20px;
            color: #333;
        }

        .content-section h2 a {
            color: inherit;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .content-section h2 a:hover {
            color: #667eea;
        }

        .content-section img {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .content-section p {
            font-size: 16px;
            line-height: 1.8;
            color: #555;
            max-width: 800px;
        }

        /* Footer */
        .site-footer {
            text-align: center;
            padding: 40px 20px;
            background-color: #333;
            color: white;
            font-size: 16px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .site-header h1 {
                font-size: 32px;
            }

            .site-header .slogan {
                font-size: 18px;
            }

            .site-header .intro-text {
                font-size: 16px;
            }

            .content-section h2 {
                font-size: 24px;
            }

            .content-section {
                padding: 40px 20px;
            }
        }

        /* Error Message */
        .error-message {
            background-color: #fee;
            border: 2px solid #fcc;
            border-radius: 8px;
            padding: 20px;
            margin: 40px auto;
            max-width: 800px;
            color: #c33;
        }

        .error-message h2 {
            margin-bottom: 10px;
        }

        .error-message ul {
            margin-left: 20px;
            margin-top: 10px;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div id="loading">Loading your website...</div>
    
    <div id="content">
        <!-- Content will be dynamically generated here -->
    </div>

    <script>
        // ============================================
        // CONFIGURATION - EDIT THIS SECTION
        // ============================================
        
        // Replace with your Google Sheet ID
        // Find it in your sheet URL: https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit
        const SHEET_ID = '1xanlmg5nOmLs5rTFBV3P9bCVNVabNFIdF9x_ilDIx0Q';
        
        // Sheet names (you can change these if you rename your tabs)
        const CONTENT_SHEET_NAME = 'Sheet1';
        const STYLING_SHEET_NAME = 'Styling';
        
        // ============================================
        // DO NOT EDIT BELOW THIS LINE
        // ============================================

        // Google Sheets CSV export URLs
        const CONTENT_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${CONTENT_SHEET_NAME}`;
        const STYLING_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${STYLING_SHEET_NAME}`;

        // Parse CSV data
        function parseCSV(csv) {
            const lines = csv.split('\n');
            const result = [];
            
            for (let line of lines) {
                // Handle quoted fields that may contain commas
                const row = [];
                let currentField = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    
                    if (char === '"') {
                        if (inQuotes && line[i + 1] === '"') {
                            currentField += '"';
                            i++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        row.push(currentField.trim());
                        currentField = '';
                    } else {
                        currentField += char;
                    }
                }
                row.push(currentField.trim());
                
                // ALWAYS push the row, even if empty - this preserves row numbering
                result.push(row);
            }
            
            return result;
        }

        // Fetch and parse Google Sheet data
        async function fetchSheetData(url) {
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const csv = await response.text();
                return parseCSV(csv);
            } catch (error) {
                console.error('Error fetching sheet data:', error);
                return null;
            }
        }

        // Apply styling from the Styling sheet
        function applyCustomStyling(stylingData) {
            if (!stylingData || stylingData.length < 2) return;

            // Default styling values
            const defaults = {
                mainHeaderColor: '#ffffff',
                sectionHeaderColor: '#333333',
                textColor: '#555555',
                backgroundColor: '#ffffff',
                linkColor: '#667eea',
                mainHeaderSize: '48px',
                sectionHeaderSize: '32px',
                textSize: '16px'
            };

            // Extract styling values - Find by label in Column A, then get values from Column B (colors) and Column C (sizes)
            const getColorByLabel = (label) => {
                const row = stylingData.find(row => row[0] === label);
                return row ? row[1] : defaults[label.replace(/\s+/g, '').replace('Color', 'Color')];
            };

            const getSizeByLabel = (label) => {
                const row = stylingData.find(row => row[0] === label);
                return row ? row[2] : defaults[label.replace(/\s+/g, '').replace('Size', 'Size')];
            };

            const mainHeaderColor = getColorByLabel('Main Header Color');
            const sectionHeaderColor = getColorByLabel('Section Header Color');
            const textColor = getColorByLabel('Body Text Color');
            const backgroundColor = getColorByLabel('Background Color');
            const linkColor = getColorByLabel('Link Hover Color');
            
            const mainHeaderSize = getSizeByLabel('Main Header Color');
            const sectionHeaderSize = getSizeByLabel('Section Header Color');
            const textSize = getSizeByLabel('Body Text Color');

            // Apply styles dynamically
            const style = document.createElement('style');
            style.textContent = `
                body {
                    background-color: ${backgroundColor};
                }
                .site-header h1 {
                    color: ${mainHeaderColor};
                    font-size: ${mainHeaderSize};
                }
                .content-section h2 {
                    color: ${sectionHeaderColor};
                    font-size: ${sectionHeaderSize};
                }
                .content-section p {
                    color: ${textColor};
                    font-size: ${textSize};
                }
                .content-section h2 a:hover {
                    color: ${linkColor};
                }
                .site-header .slogan,
                .site-header .intro-text {
                    color: ${mainHeaderColor};
                }
            `;
            document.head.appendChild(style);
        }

        // Generate site header (Row 2)
        function generateSiteHeader(row) {
            const mainHeader = row[1] || 'Welcome to My Website'; // Column B
            const heroImage = row[2] || ''; // Column C
            const slogan = row[3] || ''; // Column D
            const introText = row[4] || ''; // Column E
            const footerText = row[5] || ''; // Column F

            let headerHTML = `
                <div class="site-header">
                    <div class="container">
                        <h1>${mainHeader}</h1>
            `;

            if (heroImage) {
                headerHTML += `<img src="${heroImage}" alt="Hero Image" class="hero-image">`;
            }

            if (slogan) {
                headerHTML += `<p class="slogan">${slogan}</p>`;
            }

            if (introText) {
                headerHTML += `<p class="intro-text">${introText}</p>`;
            }

            headerHTML += `
                    </div>
                </div>
            `;

            return { headerHTML, footerText };
        }

        // Generate content section (Row 5+)
        function generateContentSection(row) {
            const header = row[0] || ''; // Column A
            const link = row[1] || ''; // Column B
            const image = row[2] || ''; // Column C
            const text = row[3] || ''; // Column D

            // Skip empty rows and label rows
            if (!header && !text && !image) return '';
            
            // Skip if this looks like a label row or placeholder (---, --)
            if (header.toLowerCase().includes('section header') || 
                header.toLowerCase().includes('field name') ||
                header === '---' || header === '--' || 
                header.trim() === '' || header.trim() === '-') return '';

            let sectionHTML = `
                <div class="content-section">
                    <div class="container">
            `;

            if (header) {
                if (link) {
                    sectionHTML += `<h2><a href="${link}" target="_blank">${header}</a></h2>`;
                } else {
                    sectionHTML += `<h2>${header}</h2>`;
                }
            }

            if (image) {
                sectionHTML += `<img src="${image}" alt="${header}">`;
            }

            if (text) {
                sectionHTML += `<p>${text}</p>`;
            }

            sectionHTML += `
                    </div>
                </div>
            `;

            return sectionHTML;
        }

        // Show error message
        function showError(message) {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="error-message">
                    <h2>⚠️ Configuration Error</h2>
                    <p>${message}</p>
                    <ul>
                        <li>Make sure you've replaced 'YOUR_SHEET_ID_HERE' with your actual Google Sheet ID</li>
                        <li>Verify your Google Sheet is set to "Anyone with the link can view"</li>
                        <li>Check that your sheet has tabs named "Sheet1" and "Styling"</li>
                        <li>Ensure your sheet has the proper label rows (Row 1 and Row 4 in Content sheet)</li>
                    </ul>
                </div>
            `;
            document.getElementById('loading').classList.add('hidden');
            content.classList.add('visible');
        }

        // Main function to build the website
        async function buildWebsite() {
            // Check if Sheet ID is configured
            if (SHEET_ID === 'YOUR_SHEET_ID_HERE') {
                showError('Please configure your Google Sheet ID in the index.html file.');
                return;
            }

            // Fetch content data
            const contentData = await fetchSheetData(CONTENT_URL);
            if (!contentData) {
                showError('Unable to fetch content from Google Sheet. Please check your Sheet ID and sharing settings.');
                return;
            }

            // Debug: Log the first few rows
            console.log('Content data:', contentData.slice(0, 6));

            // Fetch styling data (optional)
            const stylingData = await fetchSheetData(STYLING_URL);
            if (stylingData) {
                // Debug: Log styling data
                console.log('Styling data:', stylingData.slice(0, 6));
                applyCustomStyling(stylingData);
            }

            // Build the website
            let websiteHTML = '';
            let footerText = '';

            // Process Row 2 (Site Header - Row 1 is labels)
            if (contentData.length > 1) {
                const { headerHTML, footerText: footer } = generateSiteHeader(contentData[1]);
                websiteHTML += headerHTML;
                footerText = footer;
            }

            // Process Row 6+ (Content Sections - starting from row 6 which is index 5)
            // Row 1: Field labels
            // Row 2: Site header data
            // Row 3-4: Empty
            // Row 5: Section labels
            // Row 6+: Actual content sections
            for (let i = 5; i < contentData.length; i++) {
                websiteHTML += generateContentSection(contentData[i]);
            }

            // Add footer
            if (footerText) {
                websiteHTML += `
                    <div class="site-footer">
                        <div class="container">
                            <p>${footerText}</p>
                        </div>
                    </div>
                `;
            }

            // Display the website
            const content = document.getElementById('content');
            content.innerHTML = websiteHTML;
            
            // Update page title if main header exists (Row 2, Column B)
            if (contentData.length > 1 && contentData[1][1]) {
                document.title = contentData[1][1];
            }

            // Hide loading, show content
            document.getElementById('loading').classList.add('hidden');
            content.classList.add('visible');
        }

        // Initialize the website when page loads
        window.addEventListener('DOMContentLoaded', buildWebsite);
    </script>
</body>
</html>
